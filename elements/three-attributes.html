<link rel="import" href="./dat-inputs.html">

<polymer-element name="three-attribute" attributes="param min max step">
  <template>
    <style type="text/css">
      @host {
          * {
              display: block;
              font-size: 12px;
              margin: 2px 0;
              background: rgba(0, 0, 0, 0.1);
              padding: 2px 0;
          }

          * > #label {
              display: inline-block;
              vertical-align: middle;
              overflow: hidden;
              text-overflow: ellipsis;  
              text-align: right;
              padding: 0 5px 0 0;
              width: 90px;
          }

          * > #input {
              display: inline-block;
              vertical-align: middle;
              font-size: 12px;
              width: calc(100% - 95px);
          }

          * > .linked {
              color: #e2aa07;
              cursor: pointer;
          }
          
          * > .toggleable {
              cursor: pointer;
          }

      }
    </style>
    <span id="label">{{param}}</span><span id="input"></span>
  </template>
  <script>
    (function(){

      var getTag = function( object ) {
          var tag = null;
          if ( typeof object === 'string' ) tag = 'dat-input-string';
          else if ( typeof object === 'number' ) tag = 'dat-input-number';
          else if ( typeof object === 'boolean' ) tag = 'dat-input-boolean';
          else if ( object instanceof Float32Array && object.length == 2 ) tag = 'dat-input-vector2';
          else if ( object instanceof Float32Array && object.length == 3 ) tag = 'dat-input-vector3';
          else if ( object instanceof Float32Array && object.length == 4 ) tag = 'dat-input-vector4';
          return tag;
      }

      Polymer('three-attribute', {
        model: null,
        param: null,
        min: undefined,
        max: undefined,
        step: undefined,
        addInput: function( tag, model, attribute ) {
            var editor = document.createElement(tag);
            editor.id = 'input';
            editor.bindProperty('value', model, attribute);
            this.$.input.appendChild(editor);
            if (this.min) editor.min = this.min;
            if (this.max) editor.max = this.max;
            if (this.step) editor.step = this.step;            
            if ( tag == "dat-input-boolean" ) {
              this.$.label.className = 'toggleable';
              this.$.label.onclick = function() {
                editor.toggle();
              }
            }
        },
        paramChanged: function() {
          var scope = this;
          var tag = getTag(window[this.param]);          
          if (tag) this.addInput( tag, window, this.param );
        }
      });
    })();
  </script>
</polymer-element>